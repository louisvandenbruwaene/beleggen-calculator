{% extends "base.html" %}

{% block title %}Instellingen{% endblock %}

{% block content %}
<div class="dashboard-header">
    <div>
        <a href="{{ url_for('dashboard') }}" class="text-muted" style="font-size: 0.875rem;">
            ‚Üê Terug naar Dashboard
        </a>
        <h1>Account Instellingen</h1>
        <p class="text-muted">Beheer uw account en beveiligingsinstellingen</p>
    </div>
</div>

<div class="settings-grid">
    <!-- Account Info -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Account Informatie</h2>
        </div>
        <div class="info-row">
            <span class="info-label">Gebruikersnaam</span>
            <span class="info-value">{{ user.username }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">E-mailadres</span>
            <span class="info-value">{{ user.email }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Account aangemaakt</span>
            <span class="info-value">{{ user.created_at.strftime('%d/%m/%Y') }}</span>
        </div>
        <div class="info-row">
            <span class="info-label">Aantal portfolio's</span>
            <span class="info-value">{{ user.portfolios|length }}</span>
        </div>
    </div>

    <!-- Change Password -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Wachtwoord Wijzigen</h2>
        </div>
        <form method="POST" action="{{ url_for('change_password') }}">
            <div class="form-group">
                <label class="form-label" for="current_password">Huidig Wachtwoord</label>
                <input type="password" id="current_password" name="current_password"
                       class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="new_password">Nieuw Wachtwoord</label>
                <input type="password" id="new_password" name="new_password"
                       class="form-input" required minlength="8">
                <p class="form-hint">Minimaal 8 tekens</p>
            </div>
            <div class="form-group">
                <label class="form-label" for="confirm_password">Bevestig Nieuw Wachtwoord</label>
                <input type="password" id="confirm_password" name="confirm_password"
                       class="form-input" required minlength="8">
            </div>
            <button type="submit" class="btn btn-primary">Wachtwoord Wijzigen</button>
        </form>
    </div>

    <!-- Change Email -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">E-mailadres Wijzigen</h2>
        </div>
        <form method="POST" action="{{ url_for('change_email') }}">
            <div class="form-group">
                <label class="form-label" for="new_email">Nieuw E-mailadres</label>
                <input type="email" id="new_email" name="new_email"
                       class="form-input" required placeholder="nieuw@email.be">
            </div>
            <div class="form-group">
                <label class="form-label" for="email_password">Wachtwoord ter bevestiging</label>
                <input type="password" id="email_password" name="password"
                       class="form-input" required>
            </div>
            <button type="submit" class="btn btn-primary">E-mail Wijzigen</button>
        </form>
    </div>

    <!-- Delete Account -->
    <div class="card card-danger">
        <div class="card-header">
            <h2 class="card-title text-error">Account Verwijderen</h2>
        </div>
        <p class="text-muted mb-md">
            Let op: deze actie is permanent en kan niet ongedaan worden gemaakt.
            Al uw portfolio's en gegevens worden definitief verwijderd.
        </p>
        <form method="POST" action="{{ url_for('delete_account') }}"
              onsubmit="return confirm('Weet u zeker dat u uw account wilt verwijderen? Deze actie kan niet ongedaan worden gemaakt.');">
            <div class="form-group">
                <label class="form-label" for="delete_password">Wachtwoord ter bevestiging</label>
                <input type="password" id="delete_password" name="password"
                       class="form-input" required>
            </div>
            <button type="submit" class="btn btn-danger">Account Definitief Verwijderen</button>
        </form>
    </div>
</div>

<style>
.settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: var(--spacing-lg);
}

.info-row {
    display: flex;
    justify-content: space-between;
    padding: var(--spacing-md) 0;
    border-bottom: 1px solid var(--color-gray-100);
}

.info-row:last-child {
    border-bottom: none;
}

.info-label {
    color: var(--color-gray-600);
}

.info-value {
    font-weight: 500;
}

.card-danger {
    border: 1px solid var(--color-error);
}

@media (max-width: 500px) {
    .settings-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
